{% extends "main/base.html" %}
{% load static %}
{% block body %}
<div class="image_container">

  <div class="image_text hidden">
    FLATAPS: Make learning fun and easy.
  </div>
</div>
{% for forum in forums%}
<div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl m-3">
  <div class="md:flex">
    <div class="p-4">
      <div class="uppercase tracking-wide text-sm text-green-500 font-semibold author">{{forum.author.username}}</div>
      <a href="#" class="block mt-1 text-lg leading-tight font-medium text-black hover:underline">{{forum.title}}</a>
      <p class="mt-2 text-gray-600 ">{{forum.description}}</p>
    </div>
  </div>

  <div class="px-4  bg-gray-200 flex justify-between">
    <span class="text-sm text-gray-700 bg bg-gray-300 rounded-lg"><button
        class="px-2 py-1 text-lg font-extrabold bg-gray-300 rounded-full">&#8593;
      </button>{{forum.likes}}<button class="px-2  py-1 text-lg font-extrabold bg-gray-300 rounded-full">&#8595;
      </button></span>
    <span class="text-sm text-gray-600 flex items-center">{{forum.uploaded_at}}</span>
  </div>

  <div>
    <form method="POST" class="px-4 py-2 bg-green-200 flex justify-between" action="{% url 'comment'  %}">
      {% csrf_token %}
      <textarea name="text" type="text" placeholder="Add a comment" class="rounded-md px-4 text-left "></textarea>
      <input name="id" value="{{forum.id}}" hidden>
      <button type="submit" class="text-green-700 bg-green-300 px-3 rounded-lg">Comment</button>

    </form>
  </div>

  {% for comment in forum.comments_ordered.all %}
  <div class="flex bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl m-3">
    <div>|
      |

    </div>
    <div>
      <div class="flex">
        <div class="p-4 ">
          <div class="uppercase tracking-wide text-sm text-blue-500 font-semibold author">{{comment.author.username}}
          </div>

          <p class="mt-2 text-gray-500 size-fit ">{{comment.text}}</p>
        </div>
      </div>

      <div class="px-4 py-2 bg-gray-200 text-right ">

        <span class="text-sm text-gray-600  ">{{comment.uploaded_at}}</span>
      </div>

      <div>
        <form method="POST" class="px-4 py-2 bg-green-200 flex justify-between" action="{% url 'reply'  %}">
          {% csrf_token %}
          <textarea name="text" type="text" placeholder="Add a comment" class="rounded-md px-4 text-left "></textarea>
          <input name="comment_id" value="{{comment.id}}" hidden>
          <input name="fid" value="{{forum.id}}" hidden>
          <button type="submit" class="text-green-700 bg-green-300 px-3 rounded-lg">Comment</button>

        </form>
      </div>
    </div>



    {% for reply in comment.reply_ordered.all %}





    <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl m-3">
      <div class="md:flex">
        <div class="p-8 ">
          <div class="uppercase tracking-wide text-sm text-purple-500 font-semibold author">{{reply.author.username}}
          </div>

          <p class="mt-2 text-gray-500 size-fit ">{{ reply.text }}</p>
        </div>
      </div>

      <div class="px-4 py-2 bg-gray-200 text-right ">

        <span class="text-sm text-gray-600  ">{{reply.uploaded_at}}</span>
      </div>



    </div>
    {% empty %}

    {% endfor %}
  </div>

  {%empty%}
  <p class="m-3 text-center text-gray-500">No comments</p>
  {% endfor%}
</div>



{% endfor %}

<script src="{% static 'js/flashcard.js' %}"></script>
{% endblock %}